"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[2856],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),p=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=p(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),m=r,f=d["".concat(s,".").concat(m)]||d[m]||u[m]||i;return n?a.createElement(f,o(o({ref:t},c),{},{components:n})):a.createElement(f,o({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},70084:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const i={title:"APIs Casbin expos\xe9es",description:"Utilisation des APIs Casbin expos\xe9es pour g\xe9rer les droits d'acc\xe8s des utilisateurs dans les organisations",keywords:["permissions","Casbin"],authors:["MagicalSheep"]},o=void 0,l={unversionedId:"permission/exposed-casbin-apis",id:"permission/exposed-casbin-apis",title:"APIs Casbin expos\xe9es",description:"Utilisation des APIs Casbin expos\xe9es pour g\xe9rer les droits d'acc\xe8s des utilisateurs dans les organisations",source:"@site/i18n/fr/docusaurus-plugin-content-docs/current/permission/exposed-casbin-apis.md",sourceDirName:"permission",slug:"/permission/exposed-casbin-apis",permalink:"/fr/docs/permission/exposed-casbin-apis",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/permission/exposed-casbin-apis.md",tags:[],version:"current",frontMatter:{title:"APIs Casbin expos\xe9es",description:"Utilisation des APIs Casbin expos\xe9es pour g\xe9rer les droits d'acc\xe8s des utilisateurs dans les organisations",keywords:["permissions","Casbin"],authors:["MagicalSheep"]},sidebar:"tutorialSidebar",previous:{title:"Configuration des permissions",permalink:"/fr/docs/permission/permission-configuration"},next:{title:"Adaptateur",permalink:"/fr/docs/permission/adapter"}},s={},p=[{value:"Introduction",id:"introduction",level:2},{value:"Enforcer",id:"enforcer",level:3},{value:"BatchEnforce",id:"batchenforce",level:3},{value:"GetAllObjects",id:"getallobjects",level:3},{value:"GetAllActions",id:"getallactions",level:3},{value:"GetAllRoles",id:"getallroles",level:3}],c={toc:p};function u(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Supposons que le front-end de votre application a obtenu le ",(0,r.kt)("inlineCode",{parentName:"p"},"access_token")," de l'utilisateur connect\xe9 et souhaite maintenant authentifier l'utilisateur pour certains acc\xe8s. Vous ne pouvez pas simplement placer le ",(0,r.kt)("inlineCode",{parentName:"p"},"access_token")," dans l'en-t\xeate de la requ\xeate HTTP pour utiliser ces APIs car Casdoor utilise le champ ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization")," pour v\xe9rifier la permission d'acc\xe8s. Comme toutes les autres APIs fournies par Casdoor, le champ ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization")," se compose de l'identifiant client de l'application et du secret, en utilisant le ",(0,r.kt)("a",{parentName:"p",href:"https://datatracker.ietf.org/doc/html/rfc7617"},"sch\xe9ma d'authentification HTTP de base"),". \xc7a ressemble \xe0 ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization: Basic <Votre_Application_ClientId> <Votre_Application_ClientSecret>"),". Pour cette raison, les APIs Casbin doivent \xeatre appel\xe9es par le serveur backend de l'application. Voici les \xe9tapes \xe0 suivre."),(0,r.kt)("p",null,"Prenez l'application ",(0,r.kt)("a",{parentName:"p",href:"https://door.casdoor.com/applications/casbin/app-vue-python-example"},"app-vue-python-example")," sur le site de d\xe9monstration par exemple, l'en-t\xeate d'autorisation devrait \xeatre : ",(0,r.kt)("inlineCode",{parentName:"p"},"Authorization: Basic 294b09fbc17f95daf2fe dd8982f7046ccba1bbd7851d5c1ece4e52bf039d"),"."),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"Le front-end transmet le ",(0,r.kt)("inlineCode",{parentName:"li"},"access_token")," au serveur backend via l'en-t\xeate de la requ\xeate HTTP."),(0,r.kt)("li",{parentName:"ol"},"Le serveur backend r\xe9cup\xe8re l'identifiant de l'utilisateur \xe0 partir du ",(0,r.kt)("inlineCode",{parentName:"li"},"access_token"),".")),(0,r.kt)("p",null,"Comme note pr\xe9alable, ces interfaces sont \xe9galement con\xe7ues (pour l'instant) pour le mod\xe8le ",(0,r.kt)("inlineCode",{parentName:"p"},"(sub, obj, act)"),". Le ",(0,r.kt)("inlineCode",{parentName:"p"},"permissionId")," dans les param\xe8tres de l'URL est l'identit\xe9 de la politique de permission appliqu\xe9e, qui se compose du nom de l'organisation et du nom de la politique de permission (c'est-\xe0-dire, ",(0,r.kt)("inlineCode",{parentName:"p"},"nom de l'organisation/nom de la permission"),"). Le corps est le format de requ\xeate d\xe9fini par le mod\xe8le Casbin de la permission, repr\xe9sentant g\xe9n\xe9ralement ",(0,r.kt)("inlineCode",{parentName:"p"},"sub"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"obj")," et ",(0,r.kt)("inlineCode",{parentName:"p"},"act")," respectivement."),(0,r.kt)("p",null,"En plus de l'interface API pour demander l'application du contr\xf4le des permissions, Casdoor fournit \xe9galement d'autres interfaces qui aident les applications externes \xe0 obtenir des informations sur la politique de permission, qui sont \xe9galement list\xe9es ici."),(0,r.kt)("h3",{id:"enforcer"},"Enforcer"),(0,r.kt)("p",null,"Requ\xeate :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request POST 'http://localhost:8000/api/enforce?permissionId=example-org/example-permission' \\\n--header 'Content-Type: application/json' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>' \\\n--data-raw '[\"example-org/example-user\", \"example-resource\", \"example-action\"]'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "sub": "",\n    "name": "",\n    "data": [\n        true\n    ],\n    "data2": null\n}\n')),(0,r.kt)("h3",{id:"batchenforce"},"BatchEnforce"),(0,r.kt)("p",null,"Requ\xeate :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},'curl --location --request POST \'http://localhost:8000/api/batch-enforce?permissionId=example-org/example-permission\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>\' \\\n--data-raw \'[["example-org/example-user", "example-resource", "example-action"], ["example-org/example-user2", "example-resource", "example-action"], ["example-org/example-user3", "example-resource", "example-action"]]\'\n')),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'{\n    "status": "ok",\n    "msg": "",\n    "sub": "",\n    "name": "",\n    "data": [\n        [\n            true,\n            true,\n            false\n        ]\n    ],\n    "data2": null\n}\n')),(0,r.kt)("h3",{id:"getallobjects"},"GetAllObjects"),(0,r.kt)("p",null,"Requ\xeate :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-objects' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n    "app-built-in"\n]\n')),(0,r.kt)("h3",{id:"getallactions"},"GetAllActions"),(0,r.kt)("p",null,"Requ\xeate :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-actions' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n    "read",\n    "write",\n    "admin"\n]\n')),(0,r.kt)("h3",{id:"getallroles"},"GetAllRoles"),(0,r.kt)("p",null,"Requ\xeate :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"curl --location --request GET 'http://localhost:8000/api/get-all-roles' \\\n--header 'Authorization: Basic <Your_Application_ClientId> <Your_Application_ClientSecret>'\n")),(0,r.kt)("p",null,"R\xe9ponse :"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-json"},'[\n    "role_kcx66l"\n]\n')))}u.isMDXComponent=!0}}]);