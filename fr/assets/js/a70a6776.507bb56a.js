"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[482],{3905:(e,t,n)=>{n.d(t,{Zo:()=>p,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),s=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,d=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=s(n),m=r,k=u["".concat(d,".").concat(m)]||u[m]||c[m]||o;return n?a.createElement(k,i(i({ref:t},p),{},{components:n})):a.createElement(k,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=u;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var s=2;s<o;s++)i[s]=n[s];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},66372:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const o={title:"Nuxt",description:"Using Casdoor in a Nuxt project",keywords:["nuxt"],authors:["xiao-kong-long"]},i=void 0,l={unversionedId:"how-to-connect/nuxt",id:"how-to-connect/nuxt",title:"Nuxt",description:"Using Casdoor in a Nuxt project",source:"@site/docs/how-to-connect/nuxt.md",sourceDirName:"how-to-connect",slug:"/how-to-connect/nuxt",permalink:"/fr/docs/how-to-connect/nuxt",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/how-to-connect/nuxt.md",tags:[],version:"current",frontMatter:{title:"Nuxt",description:"Using Casdoor in a Nuxt project",keywords:["nuxt"],authors:["xiao-kong-long"]},sidebar:"tutorialSidebar",previous:{title:"Next.js",permalink:"/fr/docs/how-to-connect/nextjs"},next:{title:"OAuth 2.0",permalink:"/fr/docs/how-to-connect/oauth"}},d={},s=[{value:"Step 1: Deploy Casdoor",id:"step-1-deploy-casdoor",level:2},{value:"Step 2: Add Middleware",id:"step-2-add-middleware",level:2},{value:"Example",id:"example",level:3},{value:"Step 3: Use Casdoor SDK",id:"step-3-use-casdoor-sdk",level:2},{value:"1.Install the SDK",id:"1install-the-sdk",level:3},{value:"2.Initializing the SDK",id:"2initializing-the-sdk",level:3},{value:"Example",id:"example-1",level:3},{value:"3.Redirect to the Login Page",id:"3redirect-to-the-login-page",level:3},{value:"4.Get Token and Storage",id:"4get-token-and-storage",level:3},{value:"Step 4: Add Middleware Authentication Function",id:"step-4-add-middleware-authentication-function",level:2},{value:"Example",id:"example-2",level:3}],p={toc:s};function c(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},p,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://github.com/casdoor/nuxt-auth"},"nuxt-auth")," is an example of how to integrate casdoor in a nuxt project. We will guide you through the steps below. Many steps are similar to nextjs-auth."),(0,r.kt)("h2",{id:"step-1-deploy-casdoor"},"Step 1: Deploy Casdoor"),(0,r.kt)("p",null,"Firstly, Casdoor should be deployed."),(0,r.kt)("p",null,"You can refer to the Casdoor official documentation for the ",(0,r.kt)("a",{parentName:"p",href:"/docs/basic/server-installation"},"Server Installation"),". Please deploy your Casdoor instance in ",(0,r.kt)("strong",{parentName:"p"},"production mode"),"."),(0,r.kt)("p",null,"After a successful deployment, make sure the following:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Open your favorite browser and visit ",(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("a",{parentName:"strong",href:"http://localhost:8000"},"http://localhost:8000")),". You will see the login page of Casdoor."),(0,r.kt)("li",{parentName:"ul"},"Test the login functionality by entering ",(0,r.kt)("inlineCode",{parentName:"li"},"admin")," as the username and ",(0,r.kt)("inlineCode",{parentName:"li"},"123")," as the password.")),(0,r.kt)("p",null,"After that, you can quickly implement a Casdoor-based login page in your own app using the following steps."),(0,r.kt)("h2",{id:"step-2-add-middleware"},"Step 2: Add Middleware"),(0,r.kt)("p",null,"Middleware allows you to run code before a request is completed. Then, based on the incoming request, you can modify the response by rewriting, redirecting, modifying the request or response headers, or responding directly."),(0,r.kt)("p",null,"Create ",(0,r.kt)("inlineCode",{parentName:"p"},".js")," or ",(0,r.kt)("inlineCode",{parentName:"p"},".ts")," files in ",(0,r.kt)("inlineCode",{parentName:"p"},"middleware")," directory in the root of your project to define Middleware. And the filenames are identified as the names of middleware. For example, in ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casdoor/nuxt-auth"},"nuxt-auth"),", we create a file named ",(0,r.kt)("inlineCode",{parentName:"p"},"myMiddleware.js")," in ",(0,r.kt)("inlineCode",{parentName:"p"},"middleware")," directory, which can be refrenced as ",(0,r.kt)("inlineCode",{parentName:"p"},"myMiddleware")," in other places like ",(0,r.kt)("inlineCode",{parentName:"p"},"nuxt.config.js"),"."),(0,r.kt)("h3",{id:"example"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"//define which paths Middleware will run on\nconst protectedRoutes = [\"/profile\"];\n\nexport default function ({route, redirect}) {\n\n  if (protectedRoutes.includes(route.path)) {\n    //redirect the incoming request to a different URL\n    redirect('/login');\n  }\n}\n")),(0,r.kt)("p",null,"To make middleware work, you should add router in ",(0,r.kt)("inlineCode",{parentName:"p"},"nuxt.config.js"),", like that:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"export default {\n    // other configuations\n\n    // what to add\n    router: {\n    middleware: ['myMiddleware'] // replace to your middleware name\n  },\n}\n\n")),(0,r.kt)("p",null,"See nuxt official documentation ",(0,r.kt)("a",{parentName:"p",href:"https://nuxt.com/docs/guide/directory-structure/middleware"},"middleware")," for more details."),(0,r.kt)("h2",{id:"step-3-use-casdoor-sdk"},"Step 3: Use Casdoor SDK"),(0,r.kt)("h3",{id:"1install-the-sdk"},"1.Install the SDK"),(0,r.kt)("p",null,"First, install ",(0,r.kt)("inlineCode",{parentName:"p"},"casdoor-js-sdk")," via NPM or Yarn:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm install casdoor-js-sdk\n")),(0,r.kt)("p",null,"Or:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"yarn add casdoor-js-sdk\n")),(0,r.kt)("h3",{id:"2initializing-the-sdk"},"2.Initializing the SDK"),(0,r.kt)("p",null,"Then initialization 6 string-type parameters in the following order:"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Name"),(0,r.kt)("th",{parentName:"tr",align:null},"Required"),(0,r.kt)("th",{parentName:"tr",align:null},"Description"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"serverUrl"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Casdoor Server URL, such as ",(0,r.kt)("inlineCode",{parentName:"td"},"http://localhost:8000"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"clientId"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Application client ID")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"clientSecret"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Application client secret")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"organizationName"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Application organization")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"appName"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"Application name")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"redirectPath"),(0,r.kt)("td",{parentName:"tr",align:null},"Yes"),(0,r.kt)("td",{parentName:"tr",align:null},"redirected URL")))),(0,r.kt)("h3",{id:"example-1"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'const sdkConfig = {\n  serverUrl: "https://door.casdoor.com",\n  clientId: "294b09fbc17f95daf2fe",\n  clientSecret: "dd8982f7046ccba1bbd7851d5c1ece4e52bf039d",\n  organizationName: "casbin",\n  appName: "app-vue-python-example",\n  redirectPath: "/callback",\n};\n')),(0,r.kt)("admonition",{type:"caution"},(0,r.kt)("p",{parentName:"admonition"},"Replace the configuration values with your own Casdoor instance, especially the ",(0,r.kt)("inlineCode",{parentName:"p"},"clientId"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"clientSecret"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"serverUrl"),".")),(0,r.kt)("h3",{id:"3redirect-to-the-login-page"},"3.Redirect to the Login Page"),(0,r.kt)("p",null,"When you need to authenticate users who access your app, you can send the target URL and redirect to the login page provided by Casdoor."),(0,r.kt)("p",null,"Make sure you have added the callback URL (e.g. ",(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("a",{parentName:"strong",href:"http://localhost:8080/callback"},"http://localhost:8080/callback")),") in the application configuration beforehand."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"const CasdoorSDK = new Sdk(sdkConfig);\nCasdoorSDK.signin_redirect();\n")),(0,r.kt)("h3",{id:"4get-token-and-storage"},"4.Get Token and Storage"),(0,r.kt)("p",null,"After the Casdoor verification is passed, it will redirect back to your application with token."),(0,r.kt)("p",null,"You can opt in to use cookie to storage the token."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'CasdoorSDK.exchangeForAccessToken()\n  .then((res) => {\n    if (res && res.access_token) {\n      //Get Token\n      return CasdoorSDK.getUserInfo(res.access_token);\n    }\n  })\n  .then((res) => {\n    // Storage Token\n    Cookies.set("casdoorUser", JSON.stringify(res));\n  });\n')),(0,r.kt)("p",null,"You can refer to the Casdoor official documentation for the ",(0,r.kt)("a",{parentName:"p",href:"https://casdoor.org/docs/how-to-connect/sdk/#how-to-use-casdoor-sdk"},"How to use Casdoor SDK"),"."),(0,r.kt)("h2",{id:"step-4-add-middleware-authentication-function"},"Step 4: Add Middleware Authentication Function"),(0,r.kt)("p",null,"when users attempt to access a protected route, Middleware Authentication function verifies their identity. If the user is not authenticated, they are redirected to a login page or denied access."),(0,r.kt)("h3",{id:"example-2"},"Example"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},"import Cookies from \"js-cookie\";\n\nconst protectedRoutes = [\"/profile\"];\n\nexport default function ({route, redirect}) {\n  const casdoorUserCookie = Cookies.get('casdoorUser');\n  const isAuthenticated = !!casdoorUserCookie;\n\n  if (!isAuthenticated && protectedRoutes.includes(route.path)) {\n    redirect('/login');\n  }\n}\n")))}c.isMDXComponent=!0}}]);