"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[3279],{3905:(e,n,t)=>{t.d(n,{Zo:()=>d,kt:()=>g});var r=t(67294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function s(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var u=r.createContext({}),o=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):s(s({},n),e)),t},d=function(e){var n=o(e.components);return r.createElement(u.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,a=e.mdxType,i=e.originalType,u=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),c=o(t),g=a,k=c["".concat(u,".").concat(g)]||c[g]||p[g]||i;return t?r.createElement(k,s(s({ref:n},d),{},{components:t})):r.createElement(k,s({ref:n},d))}));function g(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var i=t.length,s=new Array(i);s[0]=c;var l={};for(var u in n)hasOwnProperty.call(n,u)&&(l[u]=n[u]);l.originalType=e,l.mdxType="string"==typeof e?e:a,s[1]=l;for(var o=2;o<i;o++)s[o]=t[o];return r.createElement.apply(null,s)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},30940:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>s,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>o});var r=t(87462),a=(t(67294),t(3905));const i={title:"Hasura",metaTitle:"Hasura | Hasura Authentifizierungs-Tutorial",metaDescription:"Erfahren Sie, wie Sie Casdoor mit Hasura integrieren, um Ihre Anwendungen mit JWT zu sichern"},s=void 0,l={unversionedId:"integration/Haskell/Hasura",id:"integration/Haskell/Hasura",title:"Hasura",description:"Vor der Integration m\xfcssen wir Casdoor lokal bereitstellen.",source:"@site/i18n/de/docusaurus-plugin-content-docs/current/integration/Haskell/Hasura.md",sourceDirName:"integration/Haskell",slug:"/integration/Haskell/Hasura",permalink:"/de/docs/integration/Haskell/Hasura",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/integration/Haskell/Hasura.md",tags:[],version:"current",frontMatter:{title:"Hasura",metaTitle:"Hasura | Hasura Authentifizierungs-Tutorial",metaDescription:"Erfahren Sie, wie Sie Casdoor mit Hasura integrieren, um Ihre Anwendungen mit JWT zu sichern"},sidebar:"tutorialSidebar",previous:{title:"Haskell",permalink:"/de/docs/category/haskell"},next:{title:"Python",permalink:"/de/docs/category/python"}},u={},o=[{value:"Casdoor-Anwendung konfigurieren",id:"casdoor-anwendung-konfigurieren",level:2},{value:"Einen Benutzer in Casdoor hinzuf\xfcgen",id:"einen-benutzer-in-casdoor-hinzuf\xfcgen",level:2},{value:"Die Hasura-App erstellen",id:"die-hasura-app-erstellen",level:2},{value:"Hasura mit Casdoor konfigurieren",id:"hasura-mit-casdoor-konfigurieren",level:2},{value:"Das JWT-Token abrufen",id:"das-jwt-token-abrufen",level:2}],d={toc:o};function p(e){let{components:n,...i}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,i,{components:n,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Vor der Integration m\xfcssen wir Casdoor lokal bereitstellen."),(0,a.kt)("p",null,"Dann k\xf6nnen wir schnell eine Casdoor-basierte Anmeldeseite in unserer eigenen App mit den folgenden Schritten implementieren."),(0,a.kt)("h2",{id:"casdoor-anwendung-konfigurieren"},"Casdoor-Anwendung konfigurieren"),(0,a.kt)("ol",null,(0,a.kt)("li",{parentName:"ol"},"Erstellen oder verwenden Sie eine bestehende Casdoor-Anwendung."),(0,a.kt)("li",{parentName:"ol"},"F\xfcgen Sie eine Weiterleitungs-URL hinzu: ",(0,a.kt)("inlineCode",{parentName:"li"},"http://CASDOOR_HOSTNAME/login")," ",(0,a.kt)("img",{alt:"Casdoor-Anwendungseinstellung",src:t(78479).Z,width:"1767",height:"146"})),(0,a.kt)("li",{parentName:"ol"},"Kopieren Sie die Client-ID; wir werden sie in den folgenden Schritten ben\xf6tigen.")),(0,a.kt)("h2",{id:"einen-benutzer-in-casdoor-hinzuf\xfcgen"},"Einen Benutzer in Casdoor hinzuf\xfcgen"),(0,a.kt)("p",null,"Jetzt haben Sie die Anwendung, aber keinen Benutzer. Das bedeutet, dass Sie einen Benutzer erstellen und ihm eine Rolle zuweisen m\xfcssen."),(0,a.kt)("p",null,'Gehen Sie zur Seite "Benutzer" und klicken Sie oben rechts auf "Benutzer hinzuf\xfcgen". Das \xf6ffnet eine neue Seite, auf der Sie den neuen Benutzer hinzuf\xfcgen k\xf6nnen.'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Bild zeigt die Benutzerseite",src:t(77596).Z,width:"1856",height:"657"})),(0,a.kt)("p",null,"Speichern Sie den Benutzer, nachdem Sie einen Benutzernamen hinzugef\xfcgt und die Organisation Hasura hinzugef\xfcgt haben (andere Details sind optional)."),(0,a.kt)("p",null,'Jetzt m\xfcssen Sie ein Passwort f\xfcr Ihren Benutzer einrichten, was Sie tun k\xf6nnen, indem Sie auf "Passwort verwalten" klicken.'),(0,a.kt)("p",null,"W\xe4hlen Sie ein Passwort f\xfcr Ihren Benutzer und best\xe4tigen Sie es."),(0,a.kt)("h2",{id:"die-hasura-app-erstellen"},"Die Hasura-App erstellen"),(0,a.kt)("p",null,"Starten Sie Hasura mit Docker oder Hasura Cloud."),(0,a.kt)("p",null,"Erstellen Sie jetzt eine ",(0,a.kt)("inlineCode",{parentName:"p"},"users"),"-Tabelle mit den folgenden Spalten:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"id")," vom Typ Text (Prim\xe4rschl\xfcssel)"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("inlineCode",{parentName:"li"},"username")," vom Typ Text")),(0,a.kt)("p",null,"Beziehen Sie sich f\xfcr Referenzen auf das Bild unten."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://graphql-engine-cdn.hasura.io/learn-hasura/assets/graphql-hasura-authentication/keycloak/hasura-create-table.png",alt:"Bild zeigt, wie man eine Tabelle in Hasura erstellt"})),(0,a.kt)("p",null,"Der n\xe4chste Schritt ist die Erstellung einer ",(0,a.kt)("inlineCode",{parentName:"p"},"user"),"-Rolle f\xfcr die App. Benutzer sollten nur ihre eigenen Datens\xe4tze sehen k\xf6nnen, aber nicht die von anderen Personen."),(0,a.kt)("p",null,"Konfigurieren Sie die ",(0,a.kt)("inlineCode",{parentName:"p"},"user"),"-Rolle wie im Bild unten gezeigt. F\xfcr weitere Informationen lesen Sie \xfcber ",(0,a.kt)("a",{parentName:"p",href:"https://hasura.io/docs/latest/graphql/core/auth/authorization/permission-rules/"},"das Konfigurieren von Berechtigungsregeln in Hasura"),"."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://graphql-engine-cdn.hasura.io/learn-hasura/assets/graphql-hasura-authentication/keycloak/hasura-set-permissions.png",alt:"Bild zeigt, wie man Berechtigungen in Hasura einstellt"})),(0,a.kt)("p",null,"Auf diese Weise k\xf6nnen Benutzer die Datens\xe4tze anderer Personen nicht lesen. Sie k\xf6nnen nur auf ihre eigenen zugreifen."),(0,a.kt)("p",null,"F\xfcr Testzwecke f\xfcgen Sie einen Dummy-Benutzer hinzu. Dies soll sicherstellen, dass Sie, wenn Sie das JWT-Token verwenden, nur die Details Ihres Benutzers sehen und nicht die Details anderer Benutzer."),(0,a.kt)("p",null,(0,a.kt)("img",{parentName:"p",src:"https://graphql-engine-cdn.hasura.io/learn-hasura/assets/graphql-hasura-authentication/keycloak/hasura-dummy-user.png",alt:"Bild zeigt, wie man einen Tabelleneintrag in Hasura hinzuf\xfcgt"})),(0,a.kt)("p",null,"Jetzt m\xfcssen Sie das ",(0,a.kt)("inlineCode",{parentName:"p"},"JWT_SECRET")," in Hasura einstellen."),(0,a.kt)("h2",{id:"hasura-mit-casdoor-konfigurieren"},"Hasura mit Casdoor konfigurieren"),(0,a.kt)("p",null,"In diesem Schritt m\xfcssen Sie das ",(0,a.kt)("strong",{parentName:"p"},"HASURA_GRAPHQL_JWT_SECRET")," zu Hasura hinzuf\xfcgen."),(0,a.kt)("p",null,"Dazu gehen Sie zur Hasura docker-compose.yaml und f\xfcgen dann das neue ",(0,a.kt)("inlineCode",{parentName:"p"},"HASURA_GRAPHQL_JWT_SECRET")," wie unten beschrieben hinzu."),(0,a.kt)("p",null,"Das ",(0,a.kt)("inlineCode",{parentName:"p"},"HASURA_GRAPHQL_JWT_SECRET")," sollte im folgenden Format sein. Denken Sie daran, ",(0,a.kt)("inlineCode",{parentName:"p"},"<Casdoor-Endpunkt>")," durch Ihre eigene Casdoor-URL zu \xe4ndern (wie ",(0,a.kt)("inlineCode",{parentName:"p"},"https://door.casdoor.com"),")"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-yaml"},'HASURA_GRAPHQL_JWT_SECRET: \'{"claims_map": {\n      "x-hasura-allowed-roles": {"path": "$.roles"},\n      "x-hasura-default-role": {"path": "$.roles[0]"},\n      "x-hasura-user-id": {"path": "$.id"}\n    },"jwk_url":"<Casdoor endpoint>/.well-known/jwks"}\'\n')),(0,a.kt)("p",null,"Speichern Sie die \xc4nderung und laden Sie den Docker neu."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"F\xfcgen Sie die Clerk JWT URL zu Hasura hinzu",src:t(40876).Z,width:"963",height:"242"})),(0,a.kt)("h2",{id:"das-jwt-token-abrufen"},"Das JWT-Token abrufen"),(0,a.kt)("p",null,"Da es keine Client-Implementierung gibt, k\xf6nnen Sie Ihr Zugriffstoken erhalten, indem Sie eine Anfrage mit der unten stehenden URL stellen:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-url"},"http://localhost:8000/login/oauth/authorize?client_id=<client ID>&response_type=code&redirect_uri=http%3A%2F%2Flocalhost%3A8080%2Flogin&scope=read&state=app-built-in<public certificate>>\n")),(0,a.kt)("p",null,"\xc4ndern Sie ",(0,a.kt)("inlineCode",{parentName:"p"},"client ID")," in die ID, die Sie zuvor kopiert haben, und geben Sie das \xf6ffentliche Zertifikat von Casdoor ein, das Sie auf der Casdoor-Zertifikatsseite finden k\xf6nnen."),(0,a.kt)("p",null,"Geben Sie dann den Benutzernamen und das Passwort ein, das Sie zuvor f\xfcr Hasura erstellt haben."),(0,a.kt)("p",null,'"Anmelden" klicken'),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Das JWT-Token abrufen",src:t(20588).Z,width:"1871",height:"846"})),(0,a.kt)("p",null,"Gehen Sie zur\xfcck zur Casdoor/Token-Seite."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Token-Seite",src:t(16786).Z,width:"1827",height:"793"})),(0,a.kt)("p",null,'Finden Sie den Benutzernamen, den Sie zuvor eingegeben haben, und klicken Sie dann auf "bearbeiten"'),(0,a.kt)("p",null,"Das Zugriffstoken kopieren"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Zugriffstoken",src:t(51355).Z,width:"1843",height:"814"})),(0,a.kt)("p",null,"Jetzt k\xf6nnen Sie das Zugriffstoken verwenden, um die authentifizierte Anfrage zu stellen. Hasura gab den entsprechenden Benutzer zur\xfcck, anstatt alle Benutzer aus der Datenbank zur\xfcckzugeben."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Bild zeigt das Zugriffstoken von Casdoor, das in Hasura verwendet wird",src:t(37884).Z,width:"1819",height:"922"})))}p.isMDXComponent=!0},40876:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/JWT-4529538a012c1b4739a3e8269107278a.png"},51355:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/access-a7d8fb20ba05b1a548f603664c912c9f.png"},78479:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/cas-5af2f28e52ed3cd92f069520979945f5.png"},37884:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/hasura-0ab496d67e2e34ed63dc93407053abe0.png"},20588:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/login-537105fddeaaeff5471ca0cd0c5e2f21.png"},16786:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/tokens-d3624b07df57028c7a6085d18855c0f5.png"},77596:(e,n,t)=>{t.d(n,{Z:()=>r});const r=t.p+"assets/images/user-bd4da280495b507962f00e452754e5a7.png"}}]);