"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[5443],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>h});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},i=Object.keys(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)a=i[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),u=d(a),h=r,m=u["".concat(s,".").concat(h)]||u[h]||c[h]||i;return a?n.createElement(m,o(o({ref:t},p),{},{components:a})):n.createElement(m,o({ref:t},p))}));function h(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=a.length,o=new Array(i);o[0]=u;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var d=2;d<i;d++)o[d]=a[d];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},88733:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>c,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const i={title:"Database",description:"Using Database Syncer to synchronize databases",keywords:["syncer","database"],authors:["Marvelousp4"]},o=void 0,l={unversionedId:"syncer/Database",id:"syncer/Database",title:"Database",description:"Using Database Syncer to synchronize databases",source:"@site/docs/syncer/Database.md",sourceDirName:"syncer",slug:"/syncer/Database",permalink:"/es/docs/syncer/Database",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/syncer/Database.md",tags:[],version:"current",frontMatter:{title:"Database",description:"Using Database Syncer to synchronize databases",keywords:["syncer","database"],authors:["Marvelousp4"]},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/es/docs/syncer/overview"},next:{title:"Keycloak",permalink:"/es/docs/syncer/Keycloak"}},s={},d=[{value:"Database Syncer",id:"database-syncer",level:2}],p={toc:d};function c(e){let{components:t,...i}=e;return(0,r.kt)("wrapper",(0,n.Z)({},p,i,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"database-syncer"},"Database Syncer"),(0,r.kt)("p",null,"The users table we created as a demo is imported from the ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor/blob/master/xlsx/user_test.xlsx"},"template XLSX file"),"."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"Table",src:a(46781).Z,width:"2244",height:"241"})),(0,r.kt)("p",null,"To create a new syncer, go to the ",(0,r.kt)("strong",{parentName:"p"},"Syncers")," tab and fill in all the required information as shown below. Then, save the changes."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"edit",src:a(77511).Z,width:"1758",height:"872"})),(0,r.kt)("admonition",{type:"tip"},(0,r.kt)("p",{parentName:"admonition"},"In general, you need to fill in at least the ",(0,r.kt)("inlineCode",{parentName:"p"},"ID")," and ",(0,r.kt)("inlineCode",{parentName:"p"},"Name")," in the Casdoor columns. Other important fields include ",(0,r.kt)("inlineCode",{parentName:"p"},"createdTime"),", ",(0,r.kt)("inlineCode",{parentName:"p"},"Password"),", and ",(0,r.kt)("inlineCode",{parentName:"p"},"DisplayName"),".")),(0,r.kt)("p",null,"The following fields are required:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Organization"),": The organization that the user will be imported to"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Name"),": The syncer name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Type"),': Select "database"'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Host"),": The original database host"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Port"),": The original database port"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"User"),": The original database username"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Password"),": The original database password"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Database type"),": All Xorm-supported databases such as MySQL, PostgreSQL, SQL Server, Oracle, and SQLite"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Database"),": The original database name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Table"),": The original user table name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Table columns")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Column name"),": The original user column name"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Column type"),": The original user column type"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Casdoor Column"),": The Casdoor user column name")),(0,r.kt)("p",null,"Optional fields:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Is hashed"),': Whether to calculate hash value. When this option is enabled, the syncer will only synchronize the user if the field of the user in the origin table is updated. If this option is disabled, the syncer will still synchronize the user even if only the field is updated. In short, the user will not be synchronized until the fields involved in the hash calculation (enabled "Is hashed") are updated.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Is key"),': Whether it is the primary key of the user in the origin table and the user in the Casdoor table. When synchronizing the database, it is determined based on the field whose "Is key" option is selected. At least one of the "Is key" buttons for fields should be selected. If none are selected, the first "Is key" option is selected by default.'),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Avatar base URL"),": When syncing users, if the ",(0,r.kt)("strong",{parentName:"li"},"Avatar base URL")," is not empty and the origin ",(0,r.kt)("strong",{parentName:"li"},"user.avatar"),' does not have the prefix "http", the new ',(0,r.kt)("strong",{parentName:"li"},"user.avatar")," will be replaced by ",(0,r.kt)("strong",{parentName:"li"},"Avatar base URL + user.avatar"),"."),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"Affiliation table"),': It is used to sync the affiliation of the user from this table in the database. Since the affiliation may be a code of type int in the "Affiliation table", it needs to be mapped to a string. Refer to ',(0,r.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor/blob/9f3ee275a8b747f914f0e74e897a79abeff96ccb/object/syncer_affiliation.go#L32"},"getAffiliationMap()"),". Casdoor has some redundant fields to borrow, so ",(0,r.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor/blob/9f3ee275a8b747f914f0e74e897a79abeff96ccb/object/syncer_util.go#L65"},"here")," we use ",(0,r.kt)("inlineCode",{parentName:"li"},"score")," to map the int code to a string name.")),(0,r.kt)("p",null,"Once you have configured the syncer, enable the ",(0,r.kt)("strong",{parentName:"p"},"Is enable")," option and save. The syncer will start working."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"users",src:a(41947).Z,width:"1784",height:"163"})),(0,r.kt)("p",null,'You can also use the "Sync" button for database synchronization.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Update")),(0,r.kt)("p",null,"When the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table columns")," are set as shown in the following figure, the update operation is performed."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"table_columns",src:a(47486).Z,width:"1755",height:"273"})),(0,r.kt)("p",null,"If the data in the two tables is different for the key, you can synchronize the data between the two tables based on the primary key."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Update user in the original table")),(0,r.kt)("video",{src:"/video/syncer/update_user.mp4",controls:"controls",width:"100%"}),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Update user in the Casdoor table")),(0,r.kt)("video",{src:"/video/syncer/update_casdoor.mp4",controls:"controls",width:"100%"}),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"Add")),(0,r.kt)("p",null,"When the ",(0,r.kt)("inlineCode",{parentName:"p"},"Table columns")," are set as shown in the following figure, the add operation is performed."),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"table_columns",src:a(47486).Z,width:"1755",height:"273"})),(0,r.kt)("p",null,"If the number of data between the two tables is different, add the data to the table with the lower number of data based on the primary key."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add user in the original table")),(0,r.kt)("video",{src:"/video/syncer/add_user.mp4",controls:"controls",width:"100%"}),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Add user in the Casdoor table")),(0,r.kt)("video",{src:"/video/syncer/add_casdoor.mp4",controls:"controls",width:"100%"}))}c.isMDXComponent=!0},77511:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_edit-435b2fa3ce01e17c2b551c6729303c24.png"},46781:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_table-b7ed36d236791d6de4e3a0e5b7c5e75e.png"},47486:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_table_columns-6251bc6562ba8ab0e90d2e9e823d52f8.png"},41947:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/syncer_database_users-ac0f4230b3b21198217baa1ebf02ea7f.png"}}]);