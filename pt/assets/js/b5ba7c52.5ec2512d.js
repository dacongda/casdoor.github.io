"use strict";(self.webpackChunkcasdoor_website=self.webpackChunkcasdoor_website||[]).push([[5349],{3905:(e,a,o)=>{o.d(a,{Zo:()=>c,kt:()=>m});var n=o(67294);function t(e,a,o){return a in e?Object.defineProperty(e,a,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[a]=o,e}function r(e,a){var o=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);a&&(n=n.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),o.push.apply(o,n)}return o}function i(e){for(var a=1;a<arguments.length;a++){var o=null!=arguments[a]?arguments[a]:{};a%2?r(Object(o),!0).forEach((function(a){t(e,a,o[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(o)):r(Object(o)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(o,a))}))}return e}function s(e,a){if(null==e)return{};var o,n,t=function(e,a){if(null==e)return{};var o,n,t={},r=Object.keys(e);for(n=0;n<r.length;n++)o=r[n],a.indexOf(o)>=0||(t[o]=e[o]);return t}(e,a);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)o=r[n],a.indexOf(o)>=0||Object.prototype.propertyIsEnumerable.call(e,o)&&(t[o]=e[o])}return t}var d=n.createContext({}),l=function(e){var a=n.useContext(d),o=a;return e&&(o="function"==typeof e?e(a):i(i({},a),e)),o},c=function(e){var a=l(e.components);return n.createElement(d.Provider,{value:a},e.children)},p={inlineCode:"code",wrapper:function(e){var a=e.children;return n.createElement(n.Fragment,{},a)}},u=n.forwardRef((function(e,a){var o=e.components,t=e.mdxType,r=e.originalType,d=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),u=l(o),m=t,b=u["".concat(d,".").concat(m)]||u[m]||p[m]||r;return o?n.createElement(b,i(i({ref:a},c),{},{components:o})):n.createElement(b,i({ref:a},c))}));function m(e,a){var o=arguments,t=a&&a.mdxType;if("string"==typeof e||t){var r=o.length,i=new Array(r);i[0]=u;var s={};for(var d in a)hasOwnProperty.call(a,d)&&(s[d]=a[d]);s.originalType=e,s.mdxType="string"==typeof e?e:t,i[1]=s;for(var l=2;l<r;l++)i[l]=o[l];return n.createElement.apply(null,i)}return n.createElement.apply(null,o)}u.displayName="MDXCreateElement"},99833:(e,a,o)=>{o.r(a),o.d(a,{assets:()=>d,contentTitle:()=>i,default:()=>p,frontMatter:()=>r,metadata:()=>s,toc:()=>l});var n=o(87462),t=(o(67294),o(3905));const r={title:"Banco de dados",description:"Usando Sincronizador de Banco de Dados para sincronizar bancos de dados",keywords:["sincronizador","banco de dados"],authors:["Marvelousp4"]},i=void 0,s={unversionedId:"syncer/Database",id:"syncer/Database",title:"Banco de dados",description:"Usando Sincronizador de Banco de Dados para sincronizar bancos de dados",source:"@site/i18n/pt/docusaurus-plugin-content-docs/current/syncer/Database.md",sourceDirName:"syncer",slug:"/syncer/Database",permalink:"/pt/docs/syncer/Database",draft:!1,editUrl:"https://github.com/casdoor/casdoor-website/edit/master/docs/syncer/Database.md",tags:[],version:"current",frontMatter:{title:"Banco de dados",description:"Usando Sincronizador de Banco de Dados para sincronizar bancos de dados",keywords:["sincronizador","banco de dados"],authors:["Marvelousp4"]},sidebar:"tutorialSidebar",previous:{title:"Vis\xe3o Geral",permalink:"/pt/docs/syncer/overview"},next:{title:"Keycloak",permalink:"/pt/docs/syncer/Keycloak"}},d={},l=[{value:"Sincronizador de Banco de Dados",id:"sincronizador-de-banco-de-dados",level:2}],c={toc:l};function p(e){let{components:a,...r}=e;return(0,t.kt)("wrapper",(0,n.Z)({},c,r,{components:a,mdxType:"MDXLayout"}),(0,t.kt)("h2",{id:"sincronizador-de-banco-de-dados"},"Sincronizador de Banco de Dados"),(0,t.kt)("p",null,"A tabela de usu\xe1rios que criamos como uma demonstra\xe7\xe3o \xe9 importada do ",(0,t.kt)("a",{parentName:"p",href:"https://github.com/casdoor/casdoor/blob/master/xlsx/user_test.xlsx"},"arquivo XLSX modelo"),"."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"Tabela",src:o(95899).Z,width:"2244",height:"241"})),(0,t.kt)("p",null,"Para criar um novo sincronizador, v\xe1 at\xe9 a aba ",(0,t.kt)("strong",{parentName:"p"},"Sincronizadores")," e preencha todas as informa\xe7\xf5es necess\xe1rias conforme mostrado abaixo. Ent\xe3o, salve as altera\xe7\xf5es."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"editar",src:o(2739).Z,width:"1758",height:"872"})),(0,t.kt)("admonition",{type:"tip"},(0,t.kt)("p",{parentName:"admonition"},"Em geral, voc\xea precisa preencher pelo menos o ",(0,t.kt)("inlineCode",{parentName:"p"},"ID")," e ",(0,t.kt)("inlineCode",{parentName:"p"},"Name")," nas colunas do Casdoor. Outros campos importantes incluem ",(0,t.kt)("inlineCode",{parentName:"p"},"createdTime"),", ",(0,t.kt)("inlineCode",{parentName:"p"},"Password")," e ",(0,t.kt)("inlineCode",{parentName:"p"},"DisplayName"),".")),(0,t.kt)("p",null,"Os seguintes campos s\xe3o obrigat\xf3rios:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Organization"),": A organiza\xe7\xe3o para a qual o usu\xe1rio ser\xe1 importado"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Name"),": O nome do sincronizador"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Type"),': Selecione "banco de dados"'),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Host"),": O host do banco de dados original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Port"),": A porta do banco de dados original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"User"),": O nome de usu\xe1rio do banco de dados original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Password"),": A senha do banco de dados original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Database type"),": Todos os bancos de dados suportados pelo Xorm, como MySQL, PostgreSQL, SQL Server, Oracle e SQLite"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Database"),": O nome do banco de dados original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Table"),": O nome da tabela de usu\xe1rios original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Colunas da tabela")),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Column name"),": O nome da coluna de usu\xe1rios original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Column type"),": O tipo da coluna de usu\xe1rios original"),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Casdoor Column"),": O nome da coluna de usu\xe1rio do Casdoor")),(0,t.kt)("p",null,"Campos opcionais:"),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Is hashed"),': Se deve calcular o valor hash. Quando esta op\xe7\xe3o est\xe1 ativada, o sincronizador s\xf3 sincronizar\xe1 o usu\xe1rio se o campo do usu\xe1rio na tabela de origem for atualizado. Se esta op\xe7\xe3o estiver desativada, o sincronizador ainda sincronizar\xe1 o usu\xe1rio mesmo que apenas o campo seja atualizado. Em resumo, o usu\xe1rio n\xe3o ser\xe1 sincronizado at\xe9 que os campos envolvidos no c\xe1lculo do hash (ativado "Is hashed") sejam atualizados.'),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Is key"),': Se \xe9 a chave prim\xe1ria do usu\xe1rio na tabela de origem e do usu\xe1rio na tabela do Casdoor. Ao sincronizar o banco de dados, \xe9 determinado com base no campo cuja op\xe7\xe3o "Is key" \xe9 selecionada. Pelo menos um dos bot\xf5es "Is key" para os campos deve ser selecionado. Se nenhum for selecionado, a primeira op\xe7\xe3o "Is key" \xe9 selecionada por padr\xe3o.'),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Avatar base URL"),": Ao sincronizar usu\xe1rios, se o ",(0,t.kt)("strong",{parentName:"li"},"Avatar base URL")," n\xe3o estiver vazio e o ",(0,t.kt)("strong",{parentName:"li"},"user.avatar"),' de origem n\xe3o tiver o prefixo "http", o novo ',(0,t.kt)("strong",{parentName:"li"},"user.avatar")," ser\xe1 substitu\xeddo por ",(0,t.kt)("strong",{parentName:"li"},"Avatar base URL + user.avatar"),"."),(0,t.kt)("li",{parentName:"ul"},(0,t.kt)("inlineCode",{parentName:"li"},"Affiliation table"),': \xc9 usada para sincronizar a filia\xe7\xe3o do usu\xe1rio a partir desta tabela no banco de dados. Como a filia\xe7\xe3o pode ser um c\xf3digo do tipo int na "Tabela de filia\xe7\xe3o", \xe9 necess\xe1rio mape\xe1-la para uma string. Consulte ',(0,t.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor/blob/9f3ee275a8b747f914f0e74e897a79abeff96ccb/object/syncer_affiliation.go#L32"},"getAffiliationMap()"),". O Casdoor tem alguns campos redundantes para emprestar, ent\xe3o ",(0,t.kt)("a",{parentName:"li",href:"https://github.com/casdoor/casdoor/blob/9f3ee275a8b747f914f0e74e897a79abeff96ccb/object/syncer_util.go#L65"},"aqui")," usamos ",(0,t.kt)("inlineCode",{parentName:"li"},"score")," para mapear o c\xf3digo int para um nome de string.")),(0,t.kt)("p",null,"Uma vez que voc\xea tenha configurado o sincronizador, ative a op\xe7\xe3o ",(0,t.kt)("strong",{parentName:"p"},"Is enable")," e salve. O sincronizador come\xe7ar\xe1 a funcionar."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"usu\xe1rios",src:o(55155).Z,width:"1784",height:"163"})),(0,t.kt)("p",null,'Voc\xea tamb\xe9m pode usar o bot\xe3o "Sincronizar" para sincroniza\xe7\xe3o de banco de dados.'),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"Atualizar")),(0,t.kt)("p",null,"Quando as ",(0,t.kt)("inlineCode",{parentName:"p"},"Colunas da tabela")," est\xe3o configuradas conforme mostrado na figura a seguir, a opera\xe7\xe3o de atualiza\xe7\xe3o \xe9 realizada."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"table_columns",src:o(67954).Z,width:"1755",height:"273"})),(0,t.kt)("p",null,"Se os dados nas duas tabelas forem diferentes para a chave, voc\xea pode sincronizar os dados entre as duas tabelas com base na chave prim\xe1ria."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Atualizar usu\xe1rio na tabela original")),(0,t.kt)("video",{src:"/video/syncer/update_user.mp4",controls:"controls",width:"100%"}),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Atualizar usu\xe1rio na tabela do Casdoor")),(0,t.kt)("video",{src:"/video/syncer/update_casdoor.mp4",controls:"controls",width:"100%"}),(0,t.kt)("p",null,(0,t.kt)("strong",{parentName:"p"},"Adicionar")),(0,t.kt)("p",null,"Quando as ",(0,t.kt)("inlineCode",{parentName:"p"},"Colunas da tabela")," est\xe3o configuradas conforme mostrado na figura a seguir, a opera\xe7\xe3o de adi\xe7\xe3o \xe9 realizada."),(0,t.kt)("p",null,(0,t.kt)("img",{alt:"table_columns",src:o(67954).Z,width:"1755",height:"273"})),(0,t.kt)("p",null,"Se o n\xfamero de dados entre as duas tabelas for diferente, adicione os dados \xe0 tabela com o menor n\xfamero de dados com base na chave prim\xe1ria."),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Adicionar usu\xe1rio na tabela original")),(0,t.kt)("video",{src:"/video/syncer/add_user.mp4",controls:"controls",width:"100%"}),(0,t.kt)("ul",null,(0,t.kt)("li",{parentName:"ul"},"Adicionar usu\xe1rio na tabela do Casdoor")),(0,t.kt)("video",{src:"/video/syncer/add_casdoor.mp4",controls:"controls",width:"100%"}))}p.isMDXComponent=!0},2739:(e,a,o)=>{o.d(a,{Z:()=>n});const n=o.p+"assets/images/syncer_database_edit-435b2fa3ce01e17c2b551c6729303c24.png"},95899:(e,a,o)=>{o.d(a,{Z:()=>n});const n=o.p+"assets/images/syncer_database_table-b7ed36d236791d6de4e3a0e5b7c5e75e.png"},67954:(e,a,o)=>{o.d(a,{Z:()=>n});const n=o.p+"assets/images/syncer_database_table_columns-6251bc6562ba8ab0e90d2e9e823d52f8.png"},55155:(e,a,o)=>{o.d(a,{Z:()=>n});const n=o.p+"assets/images/syncer_database_users-ac0f4230b3b21198217baa1ebf02ea7f.png"}}]);